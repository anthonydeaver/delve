<html>
	<head>
		<title>Delve - Haunted Mansion</title>
		<script src="http://code.jquery.com/jquery-2.1.0.min.js" type="text/javascript"></script>
		<script src="js/app/delve.js" type="text/javascript"></script>
		<script src="js/app/player.js" type="text/javascript"></script>
		<script src="js/app/DelveMap.js" type="text/javascript"></script>
		<script src="js/app/Parser.js" type="text/javascript"></script>
		<script src="js/app/Modal.js" type="text/javascript"></script>
		<script src="js/app/Rooms.js" type="text/javascript"></script>
		<script src="js/app/utils.js" type="text/javascript"></script>
		<script src="js/app/Eventer.js" type="text/javascript"></script>
		<style>
			section { padding: 10px; }
			#display header { 
				font-size: 24px; 
				font-weight: bolder; 
				border-bottom: 1px solid gray; 
				margin-bottom: 10px;
			}
			#display article#desc {
				/*min-height: 280px;*/
			}
			#nav { width: 400px; }
			#command {
				width: 380px;
				border: none;
				background-color: #000;
				color: white;
				padding: 5px;
				text-transform: uppercase;
			}
			#console {
				resize: none;
				width: 380px;
				height: 100px;
			}
			#nav table { width: 300px; margin: 0 auto; }
			#nav button { width: 100px; }
			#nav button.disabled{ opacity: 0.4; }
			#left, #map { float: left; border: 1px solid black;  height: 502px; position: relative;}
			section#left { width: 400px; height: 482px;}
			section#map { width: 500px; overflow:auto; padding: 0px;}
			#map span {
				display: block;
				border: 1px solid black;
				width: 100px;
				text-align: center;
				position: absolute;
				height: 20px;
			}

/*			.modal {
				width: 300px;
				height: auto;
				border: 1px solid black;
				position: absolute;
				top: 100px;
				left: 269px;
				background-color: white;
				padding: 10px;
			}

*/
			#modal #message {
				height: 210px;
				overflow: auto;
			}
			.eventPanel {
				background: none repeat scroll 0 0 white;
				border: 2px solid transparent;
				left: 250px;
				padding: 5px;
				position: absolute;
				top: 90px;
				width: 335px;
				z-index: 20;
			}
			.eventPanel:before {
				background-color: white;
				opacity: 0.6;
				content: " ";
				height: 700px;
				left: -252px;
				position: absolute;
				top: -100px;
				width: 1024px;
				z-index: -2;
			}

			.eventPanel:after {
				position: absolute;
				top: -2px;
				left: -2px;
				width: 100%;
				height: 100%;
				content: " ";
				border: 2px solid black;
				box-shadow: 5px 5px 5px #666666;
				z-index: -2;
			}

			.button {
				border: 1px solid black;
				width: 100px;
				text-align: center;
				cursor: pointer;
			}
		</style>
	</head>
	<body>
		<section id="left">
			<section id="display">
				<header></header>
				<article id="desc"></article>
				<article id="exits">
					Exits are:
					<ul>
					</ul>
				</article>
			</section>
			<section id="nav">
			<textarea id="console" ></textarea><br />
			<input id="command" type="text" value="> type commands here"/>
				<!-- <table>
					<tr>
						<td colspan=2 align="center">
							<button class="disabled" data-dir="north">North</button>
						</td>
					</tr>
					<tr>
						<td align="center">
							<button class="disabled" data-dir="west">West</button>
						</td>
						<td align="center">
							<button class="disabled" data-dir="east">East</button>
						</td>
					</tr>
					<tr>
						<td colspan=2 align="center">
							<button class="disabled" data-dir="south">South</button>
						</td>
					</tr>
				</table> -->
				<button id="temp" data-dir="south">Help</button>
			</section>
		</section>
		<section id="map">
		<!-- 25 'rows' high -->
		<!-- ~20 pixels per 'row' -->
		</section>
	</body>
		<script>
			var urlParams;
			var crunch = function () {
				console.log('crunching');
			    var match,
			        pl     = /\+/g,  // Regex for replacing addition symbol with a space
			        search = /([^&=]+)=?([^&]*)/g,
			        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
			        query  = window.location.search.substring(1);

			    urlParams = {};
			    while (match = search.exec(query))
			       urlParams[decode(match[1])] = decode(match[2]);
			    
			};
			crunch();
			var $event = new Eventer();
			var $delve = new Engine(urlParams);
		</script>
	</html>